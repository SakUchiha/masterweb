document.addEventListener("DOMContentLoaded",function(){let s=[];async function n(){try{const n=await fetch(`${CONFIG.API_BASE_URL}/api/lessons`);if(!n.ok)throw new Error("Failed to fetch lessons");s=await n.json(),s=s.map(s=>({...s,progress:0,level:s.difficulty,icon:"HTML"===s.category?"fab fa-html5":"CSS"===s.category?"fab fa-css3-alt":"fab fa-js"})),i(s),function(){if(!a)return;const n=s.length,e=s.filter(s=>100===s.progress).length,t=Math.round(e/n*100)||0;a.innerHTML=`\n      <div class="stat-item">\n        <span class="stat-value">${n}</span>\n        <span class="stat-label">Total Lessons</span>\n      </div>\n      <div class="stat-item">\n        <span class="stat-value">${e}</span>\n        <span class="stat-label">Completed</span>\n      </div>\n      <div class="stat-item">\n        <span class="stat-value">${t}%</span>\n        <span class="stat-label">Overall Progress</span>\n      </div>\n    `}()}catch(s){e&&(e.innerHTML='\n      <div class="error-state">\n        <i class="fas fa-exclamation-circle"></i>\n        <p>Failed to load lessons. Please try again.</p>\n        <button class="btn btn-primary" onclick="location.reload()">\n          Try Again\n        </button>\n      </div>\n    ')}}const e=document.querySelector(".lessons-grid"),t=document.querySelectorAll(".filter-btn"),a=document.querySelector(".progress-stats");function l(){!function(){if(!e)return;const s=Array(6).fill().map(()=>'\n      <div class="skeleton-card">\n        <div class="skeleton skeleton-title"></div>\n        <div class="skeleton skeleton-text"></div>\n        <div class="skeleton skeleton-text"></div>\n        <div class="skeleton skeleton-text"></div>\n      </div>\n    ').join("");e.innerHTML=`\n      <div class="loading-state">\n        <div class="spinner"></div>\n        <p>Loading lessons...</p>\n      </div>\n      ${s}\n    `}(),n(),t.forEach(n=>{n.addEventListener("click",()=>{var e;t.forEach(s=>s.classList.remove("active")),n.classList.add("active"),i("all"===(e=n.dataset.category)?s:s.filter(s=>s.category===e))})}),document.addEventListener("click",s=>{var n;s.target.closest(".start-lesson")&&(n=s.target.closest(".start-lesson").dataset.lessonId,localStorage.setItem("currentLesson",n),window.location.href=`lesson-viewer.html?id=${n}`)})}function i(s){e&&(e.innerHTML="",0!==s.length?s.forEach(s=>{const n=function(s){const n=document.createElement("div");return n.className="lesson-card",n.dataset.category=s.category,n.innerHTML=`\n      <div class="lesson-card-inner">\n        <div class="lesson-header">\n          <div class="lesson-category">\n            <i class="${s.icon}"></i>\n            <span>${s.category}</span>\n          </div>\n          <div class="lesson-meta">\n            <span class="duration"><i class="far fa-clock"></i> ${s.duration}</span>\n            <span class="difficulty ${s.difficulty.toLowerCase()}">${s.difficulty}</span>\n          </div>\n        </div>\n        <div class="lesson-content">\n          <h3>${s.title}</h3>\n          <p class="lesson-summary">${s.summary||""}</p>\n          <p class="lesson-description">${s.description||""}</p>\n          ${s.learningObjectives?`\n            <div class="learning-objectives">\n              <h4>Learning Objectives:</h4>\n              <ul>\n                ${s.learningObjectives.map(s=>`<li>${s}</li>`).join("")}\n              </ul>\n            </div>\n          `:""}\n          <div class="progress-container">\n            <div class="progress-bar" style="width: ${s.progress}%"></div>\n            <span class="progress-text">${s.progress}% Complete</span>\n          </div>\n          <button class="btn start-lesson" data-lesson-id="${s.id}">\n            ${s.progress>0?"Continue":"Start"} Lesson\n          </button>\n        </div>\n      </div>\n    `,n}(s);e.appendChild(n)}):e.innerHTML='<p class="no-lessons">No lessons found. Try a different filter.</p>')}window.loadLessons=l,window.fetchLessons=n,l()});